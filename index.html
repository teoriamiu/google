<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Sans Flex: Dashboard Pro</title>
    <script src="js/sortable.min.js"></script>
    <script src="js/chart.min.js"></script>
    
    <style>
        @font-face {
            font-family: 'GSansFlex';
            src: url('/fonts/GoogleSansFlex.ttf') format('truetype');
            font-weight: 100 1000;
        }

        :root {
            --wght: 400; --wdth: 100; --opsz: 14; --GRAD: 0; --slnt: 0; --ROND: 0;
            --bg: #0d1117; --panel: #161b22; --accent: #58a6ff;
        }

        body {
            font-family: 'GSansFlex', sans-serif;
            background: var(--bg); color: #c9d1d9;
            margin: 0; display: grid; grid-template-columns: 320px 1fr;
            height: 100vh; overflow: hidden;
        }

        /* SIDEBAR CON SORTABLE */
        .sidebar {
            background: var(--panel); padding: 20px;
            border-right: 1px solid #30363d; display: flex; flex-direction: column;
        }

        .sortable-list { display: flex; flex-direction: column; gap: 15px; margin-top: 20px; }

        .control-card {
            background: #21262d; padding: 15px; border-radius: 8px;
            cursor: grab; border: 1px solid transparent; transition: 0.2s;
        }
        .control-card:active { cursor: grabbing; border-color: var(--accent); }

        .label-row { display: flex; justify-content: space-between; font-size: 12px; margin-bottom: 8px; }
        .val { color: var(--accent); font-weight: bold; }

        input[type="range"] { width: 100%; accent-color: var(--accent); }

        /* PREVIEW AREA */
        .main-content {
            display: grid; grid-template-rows: 1fr 300px; padding: 40px; gap: 20px;
        }

        #preview-text {
            font-size: 6vw; text-align: center; align-self: center; outline: none;
            font-variation-settings: 'wght' var(--wght), 'wdth' var(--wdth), 'opsz' var(--opsz), 'GRAD' var(--GRAD), 'slnt' var(--slnt), 'ROND' var(--ROND);
            font-optical-sizing: none;
        }

        .charts-container {
            background: rgba(255,255,255,0.03); border-radius: 16px;
            padding: 20px; display: flex; justify-content: center;
        }

        .code-output {
            position: fixed; bottom: 20px; right: 20px;
            background: #000; color: #7ee787; padding: 10px 20px;
            border-radius: 6px; font-family: monospace; font-size: 12px;
        }
    </style>
</head>
<body>

    <aside class="sidebar">
        <h2>Lab Console</h2>
        <p style="font-size: 11px; opacity: 0.6;">Arrastra las tarjetas para reordenar (SortableJS)</p>
        
        <div id="controls-list" class="sortable-list">
            <div class="control-card" data-id="wght">
                <div class="label-row"><span>WEIGHT</span> <span class="val" id="v-wght">400</span></div>
                <input type="range" id="wght" min="100" max="1000" value="400">
            </div>
            <div class="control-card" data-id="wdth">
                <div class="label-row"><span>WIDTH</span> <span class="val" id="v-wdth">100</span></div>
                <input type="range" id="wdth" min="25" max="151" value="100">
            </div>
            <div class="control-card" data-id="ROND">
                <div class="label-row"><span>ROUND</span> <span class="val" id="v-ROND">0</span></div>
                <input type="range" id="ROND" min="0" max="100" value="0">
            </div>
            <div class="control-card" data-id="GRAD">
                <div class="label-row"><span>GRADE</span> <span class="val" id="v-GRAD">0</span></div>
                <input type="range" id="GRAD" min="-200" max="150" value="0">
            </div>
            <div class="control-card" data-id="opsz">
                <div class="label-row"><span>OPTICAL</span> <span class="val" id="v-opsz">14</span></div>
                <input type="range" id="opsz" min="8" max="144" value="14">
            </div>
            <div class="control-card" data-id="slnt">
                <div class="label-row"><span>SLANT</span> <span class="val" id="v-slnt">0</span></div>
                <input type="range" id="slnt" min="-10" max="0" value="0">
            </div>
        </div>
    </aside>

    <main class="main-content">
        <div id="preview-text" contenteditable="true">Dashboard Flex</div>
        
        <div class="charts-container">
            <canvas id="fontChart"></canvas>
        </div>
    </main>

    <div class="code-output" id="css-code">font-variation-settings: ...</div>

    <script>
        // --- 1. INICIALIZAR SORTABLEJS ---
        const el = document.getElementById('controls-list');
        Sortable.create(el, {
            animation: 150,
            ghostClass: 'blue-background-class'
        });

        // --- 2. INICIALIZAR CHART.JS ---
        const ctx = document.getElementById('fontChart').getContext('2d');
        const fontChart = new Chart(ctx, {
            type: 'radar',
            data: {
                labels: ['Weight', 'Width', 'Round', 'Grade', 'Optical', 'Slant'],
                datasets: [{
                    label: 'Configuración de Fuente',
                    data: [400, 100, 0, 0, 14, 0],
                    backgroundColor: 'rgba(88, 166, 255, 0.2)',
                    borderColor: '#58a6ff',
                    borderWidth: 2
                }]
            },
            options: {
                scales: { r: { beginAtZero: true, grid: { color: '#30363d' }, ticks: { display: false } } },
                plugins: { legend: { display: false } }
            }
        });

        // --- 3. LÓGICA DE ACTUALIZACIÓN ---
        const inputs = document.querySelectorAll('input[type="range"]');
        
        function updateAll() {
            const vals = {
                wght: document.getElementById('wght').value,
                wdth: document.getElementById('wdth').value,
                ROND: document.getElementById('ROND').value,
                GRAD: document.getElementById('GRAD').value,
                opsz: document.getElementById('opsz').value,
                slnt: document.getElementById('slnt').value
            };

            // Aplicar CSS
            for (let key in vals) {
                document.documentElement.style.setProperty(`--${key}`, vals[key]);
                document.getElementById(`v-${key}`).innerText = vals[key];
            }

            // Actualizar Gráfico (Normalizando valores para que el radar se vea bien)
            fontChart.data.datasets[0].data = [
                vals.wght / 10,
                vals.wdth,
                vals.ROND,
                (vals.GRAD + 200) / 3.5,
                vals.opsz,
                Math.abs(vals.slnt) * 10
            ];
            fontChart.update();

            // Actualizar Código
            document.getElementById('css-code').innerText = `font-variation-settings: 'wght' ${vals.wght}, 'wdth' ${vals.wdth}, 'ROND' ${vals.ROND}, 'GRAD' ${vals.GRAD}, 'opsz' ${vals.opsz}, 'slnt' ${vals.slnt};`;
        }

        inputs.forEach(i => i.addEventListener('input', updateAll));
        updateAll(); // Primera carga
    </script>
</body>
</html>